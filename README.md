# rmscc2ldkcl

RMS-CloudConnected to LDK-CL Entitlement Migration Tool for Thales Sentinel EMS

## Overview

`rmscc2ldkcl` is a PowerShell-based migration tool designed to assist in the migration of entitlements from RMS-CloudConnected products to LDK-CL products within the Thales Sentinel Entitlement Management System (EMS). The tool leverages the standard REST APIs provided by Sentinel EMS to perform secure and reliable entitlement migrations.

## Features

- Automated entitlement migration from RMS-CC to LDK-CL products
- RESTful API integration with Sentinel EMS
- Dry-run mode for safe testing
- Comprehensive logging capabilities
- Error handling and validation
- Detailed migration reports

## Prerequisites

- PowerShell 5.1 or later (PowerShell 7+ recommended)
- Access to Thales Sentinel EMS instance
- Valid API credentials for Sentinel EMS
- Appropriate permissions to read and create entitlements

## Installation

1. Clone this repository:
   ```powershell
   git clone https://github.com/yourusername/rmscc2ldkcl.git
   cd rmscc2ldkcl
   ```

2. Ensure you have the required PowerShell version:
   ```powershell
   $PSVersionTable.PSVersion
   ```

## Usage

### Basic Syntax

```powershell
.\rmscc2ldkcl.ps1 -EmsUrl <EMS_URL> -ApiKey <API_KEY> -SourceProductId <SOURCE_ID> -TargetProductId <TARGET_ID>
```

### Parameters

| Parameter | Required | Description |
|-----------|----------|-------------|
| `EmsUrl` | Yes | The base URL of your Sentinel EMS instance |
| `ApiKey` | Yes | API Key for authenticating with Sentinel EMS |
| `SourceProductId` | No | The RMS-CloudConnected product ID to migrate from |
| `TargetProductId` | No | The LDK-CL product ID to migrate to |
| `DryRun` | No | Performs a dry run without making actual changes |
| `LogFile` | No | Path to log file (auto-generated by default) |

### Examples

#### Dry Run (Recommended for first use)
```powershell
.\rmscc2ldkcl.ps1 `
    -EmsUrl "https://ems.example.com" `
    -ApiKey "your-api-key-here" `
    -SourceProductId "RMS-CC-PRODUCT-123" `
    -TargetProductId "LDK-CL-PRODUCT-456" `
    -DryRun
```

#### Production Migration
```powershell
.\rmscc2ldkcl.ps1 `
    -EmsUrl "https://ems.example.com" `
    -ApiKey "your-api-key-here" `
    -SourceProductId "RMS-CC-PRODUCT-123" `
    -TargetProductId "LDK-CL-PRODUCT-456"
```

#### Test Connectivity Only
```powershell
.\rmscc2ldkcl.ps1 `
    -EmsUrl "https://ems.example.com" `
    -ApiKey "your-api-key-here"
```

## Logging

The tool automatically creates detailed log files with timestamps for each execution:
- Default log location: `rmscc2ldkcl_YYYYMMDD_HHMMSS.log`
- Logs include timestamps, severity levels, and detailed operation information
- All API calls and results are logged for audit purposes

## Security Considerations

- Store API keys securely (consider using environment variables or secure vaults)
- Never commit API keys to version control
- Use HTTPS for all EMS connections
- Review logs for sensitive information before sharing
- Test thoroughly in a non-production environment first

## Workflow

1. **Initialization**: Validates connection to EMS and API credentials
2. **Retrieval**: Fetches all entitlements from the source RMS-CC product
3. **Transformation**: Prepares entitlement data for LDK-CL format
4. **Migration**: Creates new entitlements in the target LDK-CL product
5. **Reporting**: Generates summary of successful and failed migrations

## Error Handling

The tool includes comprehensive error handling:
- API connection failures
- Authentication errors
- Invalid product IDs
- Entitlement creation failures
- Network timeouts

All errors are logged with detailed information to facilitate troubleshooting.

## Troubleshooting

### Common Issues

**Issue**: "Failed to connect to EMS"
- **Solution**: Verify the EMS URL is correct and accessible
- Check firewall/network settings

**Issue**: "Authentication failed"
- **Solution**: Verify your API key is valid and has not expired
- Ensure the API key has appropriate permissions

**Issue**: "No entitlements found"
- **Solution**: Verify the source product ID is correct
- Ensure the product has entitlements to migrate

## API Reference

This tool uses the following Sentinel EMS REST API endpoints:

- `GET /api/health` - Health check
- `GET /api/entitlements` - Retrieve entitlements
- `POST /api/entitlements` - Create new entitlements

Refer to the Thales Sentinel EMS API documentation for complete endpoint details.

## Contributing

Contributions are welcome! Please follow these guidelines:

1. Fork the repository
2. Create a feature branch
3. Make your changes with clear commit messages
4. Test thoroughly
5. Submit a pull request

## License

[Specify your license here]

## Support

For issues, questions, or contributions, please:
- Open an issue on GitHub
- Refer to Thales Sentinel EMS documentation
- Contact your Thales support representative

## Version History

### 1.0.0 (2025-10-28)
- Initial release
- Basic migration functionality
- REST API integration
- Dry-run support
- Logging capabilities

## Acknowledgments

- Thales Sentinel EMS team for API documentation
- PowerShell community for best practices

## Disclaimer

This tool is provided as-is. Always test in a non-production environment before using in production. Ensure you have proper backups before performing migrations.
